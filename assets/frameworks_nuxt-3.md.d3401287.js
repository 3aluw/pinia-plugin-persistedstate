import{_ as s,c as n,o as a,a as p}from"./app.325b5aa2.js";const u=JSON.parse('{"title":"Usage With Nuxt 3","description":"","frontmatter":{},"headers":[{"level":2,"title":"SSR enabled persistence","slug":"ssr-enabled-persistence"},{"level":2,"title":"Client-side persistence","slug":"client-side-persistence"}],"relativePath":"frameworks/nuxt-3.md","lastUpdated":1659203174000}'),l={name:"frameworks/nuxt-3.md"},e=p(`<h1 id="usage-with-nuxt-3" tabindex="-1">Usage With Nuxt 3 <a class="header-anchor" href="#usage-with-nuxt-3" aria-hidden="true">#</a></h1><p>The plugin provides a factory function to make integration with Nuxt 3 a breeze. It is assumed you have Pinia already installed with <a href="https://pinia.vuejs.org/ssr/nuxt.html" target="_blank" rel="noopener noreferrer"><code>@nuxt/pinia</code></a>.</p><h2 id="ssr-enabled-persistence" tabindex="-1">SSR enabled persistence <a class="header-anchor" href="#ssr-enabled-persistence" aria-hidden="true">#</a></h2><p>Using Nuxt Cookies allow for persistence with full SSR support. Declare a plugin by creating a <code>persistedstate.ts</code> under the <code>plugins/</code> directory.</p><div class="language-ts"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#758575;">// /plugins/persistedstate.ts</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">{</span><span style="color:#DBD7CA;"> </span><span style="color:#B8A965;">createNuxtPersistedState</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">}</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&#39;pinia-plugin-persistedstate/nuxt&#39;</span></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">{</span><span style="color:#DBD7CA;"> </span><span style="color:#B8A965;">useCookie</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">}</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&#39;#app&#39;</span><span style="color:#DBD7CA;"> </span><span style="color:#758575;">// optional import as Nuxt will auto-import it</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CA;"> </span><span style="color:#A1B567;">defineNuxtPlugin</span><span style="color:#858585;">(</span><span style="color:#B8A965;">nuxtApp</span><span style="color:#DBD7CA;"> </span><span style="color:#CB7676;">=&gt;</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">{</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#B8A965;">nuxtApp</span><span style="color:#858585;">.</span><span style="color:#B8A965;">$pinia</span><span style="color:#858585;">.</span><span style="color:#A1B567;">use</span><span style="color:#858585;">(</span><span style="color:#A1B567;">createNuxtPersistedState</span><span style="color:#858585;">(</span><span style="color:#B8A965;">useCookie</span><span style="color:#858585;">))</span></span>
<span class="line"><span style="color:#858585;">})</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// /plugins/persistedstate.ts</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1C6B48;">import</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">{</span><span style="color:#393A34;"> </span><span style="color:#8C862B;">createNuxtPersistedState</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">}</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&#39;pinia-plugin-persistedstate/nuxt&#39;</span></span>
<span class="line"><span style="color:#1C6B48;">import</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">{</span><span style="color:#393A34;"> </span><span style="color:#8C862B;">useCookie</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">}</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&#39;#app&#39;</span><span style="color:#393A34;"> </span><span style="color:#A0ADA0;">// optional import as Nuxt will auto-import it</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1C6B48;">export</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">default</span><span style="color:#393A34;"> </span><span style="color:#6C7834;">defineNuxtPlugin</span><span style="color:#8E8F8B;">(</span><span style="color:#8C862B;">nuxtApp</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#8C862B;">nuxtApp</span><span style="color:#8E8F8B;">.</span><span style="color:#8C862B;">$pinia</span><span style="color:#8E8F8B;">.</span><span style="color:#6C7834;">use</span><span style="color:#8E8F8B;">(</span><span style="color:#6C7834;">createNuxtPersistedState</span><span style="color:#8E8F8B;">(</span><span style="color:#8C862B;">useCookie</span><span style="color:#8E8F8B;">))</span></span>
<span class="line"><span style="color:#8E8F8B;">})</span></span>
<span class="line"></span></code></pre></div><p><code>createNuxtPersistedState</code> accepts <a href="/pinia-plugin-persistedstate/guide/advanced.html#global-persistence-options">global options</a> as second parameter with the following options available:</p><ul><li><a href="/pinia-plugin-persistedstate/guide/config.html#serializer"><code>serializer</code></a></li><li><a href="/pinia-plugin-persistedstate/guide/config.html#beforeRestore"><code>beforeRestore</code></a></li><li><a href="/pinia-plugin-persistedstate/guide/config.html#afterRestore"><code>afterRestore</code></a></li><li><code>cookieOptions</code></li></ul><div class="info custom-block"><p class="custom-block-title">INFO</p><p>You can specify the <a href="https://v3.nuxtjs.org/api/composables/use-cookie#options" target="_blank" rel="noopener noreferrer">cookie options</a> to the <code>cookieOptions</code> property:</p><div class="language-ts"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">{</span><span style="color:#DBD7CA;"> </span><span style="color:#B8A965;">createNuxtPersistedState</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">}</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&#39;pinia-plugin-persistedstate/nuxt&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CA;"> </span><span style="color:#A1B567;">defineNuxtPlugin</span><span style="color:#858585;">(</span><span style="color:#B8A965;">nuxtApp</span><span style="color:#DBD7CA;"> </span><span style="color:#CB7676;">=&gt;</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">{</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#B8A965;">nuxtApp</span><span style="color:#858585;">.</span><span style="color:#B8A965;">$pinia</span><span style="color:#858585;">.</span><span style="color:#A1B567;">use</span><span style="color:#858585;">(</span><span style="color:#A1B567;">createNuxtPersistedState</span><span style="color:#858585;">(</span><span style="color:#B8A965;">useCookie</span><span style="color:#858585;">,</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">{</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#E0A569;">cookieOptions</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">{</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#E0A569;">expires</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">3600</span><span style="color:#858585;">,</span><span style="color:#DBD7CA;"> </span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#E0A569;">maxAge</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#6394BF;">3600</span><span style="color:#858585;">,</span></span>
<span class="line"><span style="color:#DBD7CA;">      </span><span style="color:#E0A569;">sameSite</span><span style="color:#858585;">:</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&#39;strict&#39;</span><span style="color:#858585;">,</span></span>
<span class="line"><span style="color:#DBD7CA;">    </span><span style="color:#858585;">}</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#858585;">}))</span></span>
<span class="line"><span style="color:#858585;">})</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#1C6B48;">import</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">{</span><span style="color:#393A34;"> </span><span style="color:#8C862B;">createNuxtPersistedState</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">}</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&#39;pinia-plugin-persistedstate/nuxt&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1C6B48;">export</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">default</span><span style="color:#393A34;"> </span><span style="color:#6C7834;">defineNuxtPlugin</span><span style="color:#8E8F8B;">(</span><span style="color:#8C862B;">nuxtApp</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#8C862B;">nuxtApp</span><span style="color:#8E8F8B;">.</span><span style="color:#8C862B;">$pinia</span><span style="color:#8E8F8B;">.</span><span style="color:#6C7834;">use</span><span style="color:#8E8F8B;">(</span><span style="color:#6C7834;">createNuxtPersistedState</span><span style="color:#8E8F8B;">(</span><span style="color:#8C862B;">useCookie</span><span style="color:#8E8F8B;">,</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">{</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#B58451;">cookieOptions</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">{</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B58451;">expires</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">3600</span><span style="color:#8E8F8B;">,</span><span style="color:#393A34;"> </span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B58451;">maxAge</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#296AA3;">3600</span><span style="color:#8E8F8B;">,</span></span>
<span class="line"><span style="color:#393A34;">      </span><span style="color:#B58451;">sameSite</span><span style="color:#8E8F8B;">:</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&#39;strict&#39;</span><span style="color:#8E8F8B;">,</span></span>
<span class="line"><span style="color:#393A34;">    </span><span style="color:#8E8F8B;">}</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#8E8F8B;">}))</span></span>
<span class="line"><span style="color:#8E8F8B;">})</span></span>
<span class="line"></span></code></pre></div></div><h2 id="client-side-persistence" tabindex="-1">Client-side persistence <a class="header-anchor" href="#client-side-persistence" aria-hidden="true">#</a></h2><p>In case you do not want to use cookies, you can use the default <code>createPersistedState</code> in a client-only plugin. Declare a plugin by creating a <code>persistedstate.client.ts</code> under the <code>plugins/</code> directory.</p><div class="language-ts"><span class="copy"></span><pre class="vp-code-dark"><code><span class="line"><span style="color:#758575;">// /plugins/persistedstate.client.ts</span></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">import</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">{</span><span style="color:#DBD7CA;"> </span><span style="color:#B8A965;">createPersistedState</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">}</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">from</span><span style="color:#DBD7CA;"> </span><span style="color:#C98A7D;">&#39;pinia-plugin-persistedstate&#39;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#4D9375;">export</span><span style="color:#DBD7CA;"> </span><span style="color:#4D9375;">default</span><span style="color:#DBD7CA;"> </span><span style="color:#A1B567;">defineNuxtPlugin</span><span style="color:#858585;">(</span><span style="color:#B8A965;">nuxtApp</span><span style="color:#DBD7CA;"> </span><span style="color:#CB7676;">=&gt;</span><span style="color:#DBD7CA;"> </span><span style="color:#858585;">{</span></span>
<span class="line"><span style="color:#DBD7CA;">  </span><span style="color:#B8A965;">nuxtApp</span><span style="color:#858585;">.</span><span style="color:#B8A965;">$pinia</span><span style="color:#858585;">.</span><span style="color:#A1B567;">use</span><span style="color:#858585;">(</span><span style="color:#A1B567;">createPersistedState</span><span style="color:#858585;">())</span></span>
<span class="line"><span style="color:#858585;">})</span></span>
<span class="line"></span></code></pre><pre class="vp-code-light"><code><span class="line"><span style="color:#A0ADA0;">// /plugins/persistedstate.client.ts</span></span>
<span class="line"></span>
<span class="line"><span style="color:#1C6B48;">import</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">{</span><span style="color:#393A34;"> </span><span style="color:#8C862B;">createPersistedState</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">}</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">from</span><span style="color:#393A34;"> </span><span style="color:#B56959;">&#39;pinia-plugin-persistedstate&#39;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#1C6B48;">export</span><span style="color:#393A34;"> </span><span style="color:#1C6B48;">default</span><span style="color:#393A34;"> </span><span style="color:#6C7834;">defineNuxtPlugin</span><span style="color:#8E8F8B;">(</span><span style="color:#8C862B;">nuxtApp</span><span style="color:#393A34;"> </span><span style="color:#AB5959;">=&gt;</span><span style="color:#393A34;"> </span><span style="color:#8E8F8B;">{</span></span>
<span class="line"><span style="color:#393A34;">  </span><span style="color:#8C862B;">nuxtApp</span><span style="color:#8E8F8B;">.</span><span style="color:#8C862B;">$pinia</span><span style="color:#8E8F8B;">.</span><span style="color:#6C7834;">use</span><span style="color:#8E8F8B;">(</span><span style="color:#6C7834;">createPersistedState</span><span style="color:#8E8F8B;">())</span></span>
<span class="line"><span style="color:#8E8F8B;">})</span></span>
<span class="line"></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>Using client-only persistence when server-side rendering, the store state will most likely be the initial state and <strong>note</strong> the persisted state.</p></div>`,12),o=[e];function t(c,r,i,y,A,B){return a(),n("div",null,o)}var D=s(l,[["render",t]]);export{u as __pageData,D as default};
